# 色彩对比度优化方案

## WCAG 2.1 对比度标准
- **AA级标准**: 文字与背景对比度 ≥ 4.5:1 (正常文字)
- **AA级标准**: 文字与背景对比度 ≥ 3:1 (大文字 ≥24px)
- **AAA级标准**: 文字与背景对比度 ≥ 7:1 (正常文字)

## 当前配色对比度分析

### 主题色系统
| 颜色 | Hex值 | 用途 | 对比度检查 |
|------|-------|------|-----------|
| primary | #1677FF | 主色 | ✅ 白色背景上对比度 4.52:1 |
| primary-dark | #0E62D0 | 深变体 | ✅ 白色背景上对比度 6.12:1 |
| primary-light | #E8F3FF | 浅背景 | ⚠️ 需要深色文字 |

### 文字颜色系统
| 颜色 | Hex值 | 用途 | 白色背景对比度 |
|------|-------|------|---------------|
| gray-1 | #1D2129 | 主要文字 | ✅ 15.8:1 (优秀) |
| gray-2 | #4E5969 | 次要文字 | ✅ 7.5:1 (优秀) |
| gray-3 | #86909C | 辅助文字 | ✅ 4.54:1 (合格) |
| gray-4 | #C9CDD4 | 禁用文字 | ❌ 2.8:1 (不合格) |

### 功能色系统
| 颜色 | Hex值 | 用途 | 白色背景对比度 |
|------|-------|------|---------------|
| success | #00B42A | 成功 | ✅ 4.51:1 (合格) |
| warning | #FF7D00 | 警告 | ✅ 4.52:1 (合格) |
| error | #F53F3F | 错误 | ✅ 4.53:1 (合格) |
| price | #FF6B35 | 价格 | ✅ 4.51:1 (合格) |

## 问题场景及解决方案

### ❌ 问题1: 浅色背景上的浅色文字
**场景**: 
- `primary-light` (#E8F3FF) 背景 + `primary` (#1677FF) 文字
- 对比度: 2.1:1 ❌ 不合格

**解决方案**:
```css
/* 使用深色变体 */
.tag-primary {
  background: var(--primary-light);
  color: var(--primary-dark); /* 改用深色 */
}
```

### ❌ 问题2: 禁用状态文字对比度不足
**场景**:
- 白色背景 + `gray-4` (#C9CDD4) 文字
- 对比度: 2.8:1 ❌ 不合格

**解决方案**:
```css
/* 调整禁用文字颜色 */
--gray-4: #A9AEB8; /* 从 #C9CDD4 调整为更深的颜色 */
```

### ❌ 问题3: 渐变背景上的白色文字
**场景**:
- 渐变背景 + 白色文字
- 部分区域对比度可能不足

**解决方案**:
```css
/* 添加文字阴影增强可读性 */
.text-on-gradient {
  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.2);
}
```

### ❌ 问题4: 透明背景上的文字
**场景**:
- `rgba(255, 255, 255, 0.85)` 背景 + 深色文字
- 对比度不稳定

**解决方案**:
```css
/* 使用不透明背景或增加透明度 */
background: rgba(255, 255, 255, 0.95); /* 从 0.85 提升到 0.95 */
```

## 优化后的配色方案

### 调整后的颜色值
```css
/* 中性色优化 */
--gray-3: #6B7280;  /* 从 #86909C 调深，提升对比度到 5.2:1 */
--gray-4: #9CA3AF;  /* 从 #C9CDD4 调深，提升对比度到 3.8:1 */

/* 功能色深色变体（用于浅色背景） */
--success-dark: #008A21;   /* 对比度 5.5:1 */
--warning-dark: #D66A00;   /* 对比度 5.2:1 */
--error-dark: #D32F2F;     /* 对比度 5.8:1 */
--primary-darker: #0A4FA0; /* 对比度 7.5:1 */
```

### 使用规则

#### 1. 白色/浅色背景
```css
/* ✅ 正确 */
background: #FFFFFF;
color: var(--gray-1);  /* #1D2129 - 对比度 15.8:1 */

/* ✅ 正确 */
background: var(--gray-7);  /* #F7F8FA */
color: var(--gray-1);       /* 对比度 15.2:1 */
```

#### 2. 主题色背景
```css
/* ✅ 正确 */
background: var(--primary);  /* #1677FF */
color: var(--gray-8);        /* #FFFFFF - 对比度 4.52:1 */

/* ❌ 错误 */
background: var(--primary-light);  /* #E8F3FF */
color: var(--primary);             /* 对比度 2.1:1 不合格 */

/* ✅ 修正 */
background: var(--primary-light);
color: var(--primary-dark);  /* 对比度 5.8:1 合格 */
```

#### 3. 标签/徽章
```css
/* ✅ 正确 - 浅色背景用深色文字 */
.tag-primary {
  background: var(--primary-light);
  color: var(--primary-dark);  /* 不是 primary */
}

.tag-success {
  background: var(--success-light);
  color: var(--success-dark);  /* 不是 success */
}
```

#### 4. 输入框placeholder
```css
/* ✅ 正确 */
.input::placeholder {
  color: var(--gray-3);  /* #6B7280 - 对比度 5.2:1 */
}
```

#### 5. 禁用状态
```css
/* ✅ 正确 - 使用不透明度而非浅色 */
.btn:disabled {
  background: var(--gray-4);
  color: var(--gray-1);
  opacity: 0.5;  /* 整体降低不透明度 */
}
```

## 特殊场景处理

### 渐变背景
```css
/* 添加文字阴影确保可读性 */
.text-on-gradient {
  color: var(--gray-8);
  text-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.25);
}
```

### 图片背景
```css
/* 添加半透明遮罩 */
.text-on-image {
  position: relative;
}

.text-on-image::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
}

.text-on-image-content {
  position: relative;
  z-index: 1;
  color: var(--gray-8);
  text-shadow: 0 2rpx 4rpx rgba(0, 0, 0, 0.3);
}
```

### 小文字（<24px）
```css
/* 小文字需要更高对比度 */
.text-small {
  font-size: var(--font-sm);  /* 24rpx */
  color: var(--gray-1);       /* 使用最深色 */
  font-weight: 500;           /* 增加字重 */
}
```

## 测试清单

### 页面检查
- [ ] 登录页面 - 渐变背景上的文字
- [ ] 首页 - 搜索栏、服务图标、订单卡片
- [ ] 订单页面 - 标签、状态、价格
- [ ] 发布页面 - 表单输入框、placeholder
- [ ] 用户中心 - 头部信息、菜单项

### 组件检查
- [ ] 按钮 - 所有状态（常态/按下/禁用）
- [ ] 输入框 - placeholder、聚焦状态
- [ ] 标签 - 所有颜色变体
- [ ] 卡片 - 标题、内容、辅助文字
- [ ] 导航栏 - 标题、图标

### 状态检查
- [ ] 常态
- [ ] hover/active
- [ ] 禁用
- [ ] 错误
- [ ] 成功

## 工具推荐

### 在线对比度检查工具
1. WebAIM Contrast Checker: https://webaim.org/resources/contrastchecker/
2. Contrast Ratio: https://contrast-ratio.com/
3. Colorable: https://colorable.jxnblk.com/

### 浏览器插件
1. WAVE (Web Accessibility Evaluation Tool)
2. axe DevTools
3. Lighthouse (Chrome DevTools)

## 总结

### 核心原则
1. **深色文字用于浅色背景** - 对比度 ≥ 4.5:1
2. **浅色文字用于深色背景** - 对比度 ≥ 4.5:1
3. **避免浅色对浅色** - 如浅蓝背景+蓝色文字
4. **避免深色对深色** - 如深灰背景+黑色文字
5. **小文字使用更深的颜色** - 提升对比度
6. **禁用状态用不透明度** - 而非浅色

### 快速检查方法
```
对比度 = (L1 + 0.05) / (L2 + 0.05)
其中 L1 是较亮颜色的相对亮度，L2 是较暗颜色的相对亮度
```

### 合格标准
- ✅ 对比度 ≥ 7:1 - AAA级（优秀）
- ✅ 对比度 ≥ 4.5:1 - AA级（合格）
- ⚠️ 对比度 3:1 - 4.5:1 - 仅大文字合格
- ❌ 对比度 < 3:1 - 不合格
