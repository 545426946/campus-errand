# æ ¡å›­è·‘è…¿å°ç¨‹åº - å®Œæ•´APIæ¥å£æ–‡æ¡£

## åŸºç¡€é…ç½®

- **åŸºç¡€URL**: `http://localhost:3000/api` (å¼€å‘ç¯å¢ƒ)
- **è®¤è¯æ–¹å¼**: Bearer Token (JWT)
- **è¯·æ±‚æ ¼å¼**: JSON
- **è¶…æ—¶æ—¶é—´**: 10ç§’

## çŠ¶æ€ç è§„èŒƒ

### HTTPçŠ¶æ€ç 
- `200`: æˆåŠŸ
- `201`: åˆ›å»ºæˆåŠŸ
- `400`: è¯·æ±‚å‚æ•°é”™è¯¯
- `401`: æœªæˆæƒ
- `403`: æ— æƒé™
- `404`: èµ„æºä¸å­˜åœ¨
- `500`: æœåŠ¡å™¨é”™è¯¯

### ä¸šåŠ¡çŠ¶æ€ç 
- `code: 0`: æˆåŠŸ
- `code: 400`: ä¸šåŠ¡é”™è¯¯

## ä¸€ã€è®¤è¯ç›¸å…³æ¥å£ ğŸ”

### 1.1 ç”¨æˆ·ç™»å½•
**æ¥å£**: `POST /auth/login`

**ç”¨é€”**: æ”¯æŒä¸‰ç§ç™»å½•æ–¹å¼ï¼šå¾®ä¿¡ç™»å½•ã€ç”¨æˆ·åå¯†ç ç™»å½•ã€é‚®ç®±å¯†ç ç™»å½•

**è¯·æ±‚å‚æ•°**:
```json
// å¾®ä¿¡ç™»å½•
{
  "code": "å¾®ä¿¡ç™»å½•code"
}

// ç”¨æˆ·åå¯†ç ç™»å½•
{
  "username": "user123",
  "password": "password123"
}

// é‚®ç®±å¯†ç ç™»å½•
{
  "email": "user@example.com",
  "password": "password123"
}
```

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "user123",
    "email": "user@example.com",
    "role": "student",
    "nickname": "å°æ˜",
    "avatar": "http://..."
  },
  "message": "ç™»å½•æˆåŠŸ"
}
```

### 1.2 ç”¨æˆ·æ³¨å†Œ
**æ¥å£**: `POST /auth/register`

**ç”¨é€”**: ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç æ³¨å†Œæ–°è´¦å·

**è¯·æ±‚å‚æ•°**:
```json
{
  "username": "user123",
  "password": "password123",
  "confirmPassword": "password123",
  "email": "user@example.com" // å¯é€‰
}
```

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "username": "user123",
    "email": "user@example.com",
    "role": "student"
  },
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

**æ³¨æ„äº‹é¡¹**:
- ç”¨æˆ·åå¿…é¡»å”¯ä¸€
- å¯†ç é•¿åº¦è‡³å°‘6ä½
- å¦‚æœæä¾›confirmPasswordï¼Œå¿…é¡»ä¸passwordä¸€è‡´
- emailå­—æ®µå¯é€‰

### 1.3 å‘é€éªŒè¯ç 
**æ¥å£**: `POST /auth/send-code`

**è¯·æ±‚å‚æ•°**:
```json
{
  "phone": "13800138000",
  "email": "user@example.com",
  "type": "login"
}
```

### 1.4 éªŒè¯éªŒè¯ç 
**æ¥å£**: `POST /auth/verify-code`

**è¯·æ±‚å‚æ•°**:
```json
{
  "phone": "13800138000",
  "code": "123456"
}
```

### 1.5 é€€å‡ºç™»å½•
**æ¥å£**: `POST /auth/logout`

**éœ€è¦è®¤è¯**: âœ…

## äºŒã€ç”¨æˆ·ç®¡ç†æ¥å£ ğŸ‘¤

### 2.1 ç”¨æˆ·åŸºç¡€ä¿¡æ¯

#### è·å–ç”¨æˆ·ä¿¡æ¯
**æ¥å£**: `GET /users/profile`

**éœ€è¦è®¤è¯**: âœ…

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "id": 1,
    "username": "user123",
    "nickname": "å°æ˜",
    "avatar": "http://...",
    "phone": "13800138000",
    "email": "user@example.com"
  }
}
```

#### æ›´æ–°ç”¨æˆ·ä¿¡æ¯
**æ¥å£**: `PUT /user/info`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "nickname": "æ–°æ˜µç§°",
  "avatar": "http://...",
  "phone": "13800138000"
}
```

#### è·å–å¤´åƒ
**æ¥å£**: `GET /user/avatar`

**éœ€è¦è®¤è¯**: âœ…

#### æ›´æ–°å¤´åƒ
**æ¥å£**: `POST /user/avatar`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "avatar": "http://..."
}
```

### 2.2 å®åè®¤è¯

#### æäº¤å®åè®¤è¯
**æ¥å£**: `POST /user/certify`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "realName": "å¼ ä¸‰",
  "idCard": "110101199001011234",
  "idCardFront": "http://...",
  "idCardBack": "http://..."
}
```

#### è·å–è®¤è¯çŠ¶æ€
**æ¥å£**: `GET /user/certification/status`

**éœ€è¦è®¤è¯**: âœ…

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "status": "approved",
    "realName": "å¼ ä¸‰"
  }
}
```

#### è·å–è®¤è¯ä¿¡æ¯
**æ¥å£**: `GET /user/certification/info`

**éœ€è¦è®¤è¯**: âœ…

### 2.3 é’±åŒ…åŠŸèƒ½

#### è·å–é’±åŒ…ä¿¡æ¯
**æ¥å£**: `GET /user/wallet`

**éœ€è¦è®¤è¯**: âœ…

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "balance": 100.00,
    "frozen": 10.00,
    "total": 110.00
  }
}
```

#### è·å–é’±åŒ…æ˜ç»†
**æ¥å£**: `GET /user/wallet/details`

**éœ€è¦è®¤è¯**: âœ…

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡
- `type`: ç±»å‹ç­›é€‰

#### æç°
**æ¥å£**: `POST /user/wallet/withdraw`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "amount": 50.00,
  "account": "æ”¯ä»˜å®è´¦å·"
}
```

#### å……å€¼
**æ¥å£**: `POST /user/wallet/recharge`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "amount": 100.00,
  "paymentMethod": "wechat"
}
```

### 2.4 æ”¶è—å’Œå†å²

#### è·å–æ”¶è—åˆ—è¡¨
**æ¥å£**: `GET /user/favorites`

**éœ€è¦è®¤è¯**: âœ…

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡

#### æ·»åŠ æ”¶è—
**æ¥å£**: `POST /user/favorites`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "orderId": 123
}
```

#### å–æ¶ˆæ”¶è—
**æ¥å£**: `DELETE /user/favorites/:id`

**éœ€è¦è®¤è¯**: âœ…

#### è·å–å†å²è®°å½•
**æ¥å£**: `GET /user/history`

**éœ€è¦è®¤è¯**: âœ…

#### åˆ é™¤å†å²è®°å½•
**æ¥å£**: `DELETE /user/history/:id`

**éœ€è¦è®¤è¯**: âœ…

## ä¸‰ã€è®¢å•æ ¸å¿ƒæ¥å£ ğŸ“¦

### 3.1 è®¢å•CRUDæ“ä½œ

#### è·å–è®¢å•åˆ—è¡¨ï¼ˆå¤§å…ï¼‰
**æ¥å£**: `GET /orders`

**éœ€è¦è®¤è¯**: âœ…

**ç”¨é€”**: è·å–è®¢å•å¤§å…åˆ—è¡¨ï¼Œé»˜è®¤åªæ˜¾ç¤ºæœªå®Œæˆçš„è®¢å•ï¼ˆpendingå’ŒacceptedçŠ¶æ€ï¼‰

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤1)
- `pageSize`: æ¯é¡µæ•°é‡ (é»˜è®¤10)
- `status`: çŠ¶æ€ç­›é€‰ (é»˜è®¤: pending,accepted)
  - å¯é€‰å€¼: pending/accepted/completed/cancelled
  - æ”¯æŒå¤šä¸ªçŠ¶æ€ï¼Œç”¨é€—å·åˆ†éš”ï¼Œå¦‚: pending,accepted
- `type`: ç±»å‹ç­›é€‰
- `keyword`: å…³é”®è¯æœç´¢

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": [
    {
      "id": 1,
      "user_id": 1,
      "title": "å¿«é€’ä»£å–",
      "description": "å¸®å¿™å–ä¸ªå¿«é€’",
      "type": 1,
      "price": 5.00,
      "status": "pending",
      "publisher_name": "å°æ˜",
      "publisher_avatar": "http://...",
      "created_at": "2024-01-01T00:00:00.000Z"
    }
  ]
}
```

**è¯´æ˜**:
- è®¢å•å¤§å…é»˜è®¤ä¸æ˜¾ç¤ºå·²å®Œæˆ(completed)å’Œå·²å–æ¶ˆ(cancelled)çš„è®¢å•
- å·²å®Œæˆçš„è®¢å•ä¼šä¿ç•™åœ¨æ•°æ®åº“ä¸­ï¼Œå¯é€šè¿‡"æˆ‘å‘å¸ƒçš„è®¢å•"æˆ–"æˆ‘æ¥å—çš„è®¢å•"æŸ¥çœ‹
- æ¯ä¸ªè®¢å•éƒ½ç»‘å®šäº†å‘å¸ƒè€…çš„user_id

#### è·å–è®¢å•è¯¦æƒ…
**æ¥å£**: `GET /orders/:orderId`

**éœ€è¦è®¤è¯**: âœ…

#### åˆ›å»ºæ–°è®¢å•
**æ¥å£**: `POST /orders`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "title": "å¿«é€’ä»£å–",
  "description": "å¸®å¿™å–ä¸ªå¿«é€’",
  "type": 1,
  "price": 5.00,
  "pickupLocation": "èœé¸Ÿé©¿ç«™",
  "deliveryLocation": "å®¿èˆæ¥¼ä¸‹",
  "contactPhone": "13800138000",
  "images": ["http://..."]
}
```

#### æ›´æ–°è®¢å•
**æ¥å£**: `PUT /orders/:orderId`

**éœ€è¦è®¤è¯**: âœ…

#### åˆ é™¤è®¢å•
**æ¥å£**: `DELETE /orders/:orderId`

**éœ€è¦è®¤è¯**: âœ…

### 3.2 è®¢å•çŠ¶æ€æµè½¬

#### æ¥å•
**æ¥å£**: `POST /orders/:orderId/accept`

**éœ€è¦è®¤è¯**: âœ…

#### å–æ¶ˆè®¢å•
**æ¥å£**: `POST /orders/:orderId/cancel`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "reason": "å–æ¶ˆåŸå› "
}
```

#### å®Œæˆè®¢å•
**æ¥å£**: `POST /orders/:orderId/complete`

**éœ€è¦è®¤è¯**: âœ…

#### ç¡®è®¤æ”¶è´§
**æ¥å£**: `POST /orders/:orderId/confirm`

**éœ€è¦è®¤è¯**: âœ…

### 3.3 è®¢å•æŸ¥è¯¢åˆ†ç±»

#### æˆ‘å‘å¸ƒçš„è®¢å•
**æ¥å£**: `GET /orders/my-publish`

**éœ€è¦è®¤è¯**: âœ…

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡
- `status`: çŠ¶æ€ç­›é€‰

#### æˆ‘æ¥å—çš„è®¢å•
**æ¥å£**: `GET /orders/my-accepted`

**éœ€è¦è®¤è¯**: âœ…

#### æœç´¢è®¢å•
**æ¥å£**: `GET /orders/search`

**éœ€è¦è®¤è¯**: âœ…

**æŸ¥è¯¢å‚æ•°**:
- `keyword`: æœç´¢å…³é”®è¯
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡

#### çƒ­é—¨è®¢å•
**æ¥å£**: `GET /orders/hot`

**éœ€è¦è®¤è¯**: âœ…

#### æ¨èè®¢å•
**æ¥å£**: `GET /orders/recommended`

**éœ€è¦è®¤è¯**: âœ…

### 3.4 è®¢å•è¯„ä»·ä¸¾æŠ¥

#### è®¢å•è¯„ä»·
**æ¥å£**: `POST /orders/:orderId/evaluate`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "rating": 5,
  "comment": "æœåŠ¡å¾ˆå¥½",
  "tags": ["å¿«é€Ÿ", "å‹å¥½"]
}
```

#### è·å–è¯„ä»·
**æ¥å£**: `GET /orders/:orderId/evaluations`

**éœ€è¦è®¤è¯**: âœ…

#### ä¸¾æŠ¥è®¢å•
**æ¥å£**: `POST /orders/:orderId/report`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "reason": "è¿è§„å†…å®¹",
  "description": "è¯¦ç»†æè¿°"
}
```

#### åˆ†äº«è®¢å•
**æ¥å£**: `POST /orders/:orderId/share`

**éœ€è¦è®¤è¯**: âœ…

## å››ã€é€šçŸ¥ç³»ç»Ÿæ¥å£ ğŸ””

#### è·å–é€šçŸ¥åˆ—è¡¨
**æ¥å£**: `GET /notifications`

**éœ€è¦è®¤è¯**: âœ…

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡
- `unreadOnly`: åªçœ‹æœªè¯» (true/false)

#### æœªè¯»é€šçŸ¥æ•°é‡
**æ¥å£**: `GET /notifications/unread-count`

**éœ€è¦è®¤è¯**: âœ…

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "count": 5
  }
}
```

#### æ ‡è®°å·²è¯»
**æ¥å£**: `PUT /notifications/:notificationId/read`

**éœ€è¦è®¤è¯**: âœ…

#### å…¨éƒ¨æ ‡è®°å·²è¯»
**æ¥å£**: `PUT /notifications/read-all`

**éœ€è¦è®¤è¯**: âœ…

#### åˆ é™¤é€šçŸ¥
**æ¥å£**: `DELETE /notifications/:notificationId`

**éœ€è¦è®¤è¯**: âœ…

## äº”ã€ç³»ç»Ÿé€šç”¨æ¥å£ âš™ï¸

### 5.1 ç³»ç»Ÿé…ç½®

#### è·å–ç³»ç»Ÿé…ç½®
**æ¥å£**: `GET /system/config`

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "appName": "æ ¡å›­è·‘è…¿",
    "version": "1.0.0",
    "apiBaseUrl": "http://localhost:3000/api",
    "uploadMaxSize": 10485760,
    "orderMinPrice": 1,
    "orderMaxPrice": 1000
  }
}
```

#### è·å–æœåŠ¡ç±»å‹åˆ—è¡¨
**æ¥å£**: `GET /system/service-types`

#### è·å–ç‰ˆæœ¬ä¿¡æ¯
**æ¥å£**: `GET /system/version`

#### æ£€æŸ¥æ›´æ–°
**æ¥å£**: `POST /system/check-update`

**è¯·æ±‚å‚æ•°**:
```json
{
  "version": "1.0.0"
}
```

### 5.2 æ–‡ä»¶ä¸Šä¼ 

#### å›¾ç‰‡ä¸Šä¼ 
**æ¥å£**: `POST /upload/image`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "images": ["base64å›¾ç‰‡æ•°æ®"]
}
```

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": {
    "images": [
      {
        "url": "http://...",
        "size": 123456,
        "name": "image.jpg"
      }
    ]
  }
}
```

### 5.3 ä½ç½®æœåŠ¡

#### è·å–ä½ç½®ä¿¡æ¯
**æ¥å£**: `GET /system/location`

**æŸ¥è¯¢å‚æ•°**:
- `latitude`: çº¬åº¦
- `longitude`: ç»åº¦

#### æœç´¢åœ°ç‚¹
**æ¥å£**: `GET /system/search-location`

**æŸ¥è¯¢å‚æ•°**:
- `keyword`: æœç´¢å…³é”®è¯

#### è·å–å¤©æ°”ä¿¡æ¯
**æ¥å£**: `GET /system/weather`

**æŸ¥è¯¢å‚æ•°**:
- `city`: åŸå¸‚åç§°

### 5.4 å†…å®¹ç®¡ç†

#### è·å–å…¬å‘Šåˆ—è¡¨
**æ¥å£**: `GET /system/announcements`

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç 
- `pageSize`: æ¯é¡µæ•°é‡

#### è·å–çƒ­é—¨æœç´¢
**æ¥å£**: `GET /system/hot-search`

**å“åº”**:
```json
{
  "success": true,
  "code": 0,
  "data": ["å¿«é€’ä»£å–", "é£Ÿå ‚ä»£è´­", "æ‰“å°å¤å°"]
}
```

#### è·å–æ¨èå…³é”®è¯
**æ¥å£**: `GET /system/recommended-keywords`

#### æ•æ„Ÿè¯æ£€æŸ¥
**æ¥å£**: `POST /system/check-sensitive`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "content": "è¦æ£€æŸ¥çš„å†…å®¹"
}
```

### 5.5 ç”¨æˆ·åé¦ˆ

#### æäº¤æ„è§åé¦ˆ
**æ¥å£**: `POST /system/feedback`

**éœ€è¦è®¤è¯**: âœ…

**è¯·æ±‚å‚æ•°**:
```json
{
  "type": "bug",
  "content": "åé¦ˆå†…å®¹",
  "contact": "è”ç³»æ–¹å¼",
  "images": ["http://..."]
}
```

#### è·å–å¸®åŠ©ä¿¡æ¯
**æ¥å£**: `GET /system/help`

#### è·å–å…³äºæˆ‘ä»¬
**æ¥å£**: `GET /system/about`

#### è·å–éšç§æ”¿ç­–
**æ¥å£**: `GET /system/privacy`

#### è·å–ç”¨æˆ·åè®®
**æ¥å£**: `GET /system/agreement`

## åˆ†é¡µå‚æ•°è¯´æ˜

å¤§éƒ¨åˆ†åˆ—è¡¨æ¥å£æ”¯æŒä»¥ä¸‹åˆ†é¡µå‚æ•°ï¼š

- `page`: é¡µç  (é»˜è®¤1)
- `pageSize`: æ¯é¡µæ•°é‡ (é»˜è®¤10æˆ–20)
- `status`: çŠ¶æ€ç­›é€‰
- `keyword`: å…³é”®è¯æœç´¢

## é”™è¯¯å¤„ç†

æ‰€æœ‰æ¥å£åœ¨å‘ç”Ÿé”™è¯¯æ—¶è¿”å›ç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "success": false,
  "code": 400,
  "message": "é”™è¯¯ä¿¡æ¯æè¿°"
}
```

## è®¤è¯è¯´æ˜

éœ€è¦è®¤è¯çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Tokenï¼š

```
Authorization: Bearer <your_token_here>
```

Token åœ¨ç™»å½•æˆåŠŸåè·å–ï¼Œæœ‰æ•ˆæœŸæ ¹æ®é…ç½®è€Œå®šï¼ˆé»˜è®¤7å¤©ï¼‰ã€‚
