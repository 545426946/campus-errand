# 校园跑腿平台 - 完整测试用例

## 📋 测试用例目录

### 1. 认证模块测试
- [x] 用户注册
- [x] 用户名密码登录
- [x] 邮箱密码登录
- [x] 微信登录
- [x] Token验证
- [x] Token过期处理

### 2. 用户模块测试
- [x] 获取用户信息
- [x] 更新用户信息
- [x] 更新头像
- [x] 提交实名认证
- [x] 查询认证状态
- [x] 获取钱包信息
- [x] 获取钱包明细

### 3. 订单模块测试
- [x] 创建订单（余额充足）
- [x] 创建订单（余额不足）
- [x] 获取订单列表
- [x] 获取订单详情
- [x] 接单
- [x] 不能接自己的单
- [x] 接单者标记完成
- [x] 发布者确认完成
- [x] 取消订单（pending状态）
- [x] 取消订单（accepted状态）
- [x] 搜索订单
- [x] 我发布的订单
- [x] 我接受的订单

### 4. 钱包模块测试
- [x] 充值
- [x] 提现
- [x] 余额冻结
- [x] 余额解冻
- [x] 转账
- [x] 交易记录查询
- [x] 余额不足处理

### 5. 认证审核测试
- [x] 提交骑手认证
- [x] 获取待审核列表
- [x] 审核通过
- [x] 审核拒绝
- [x] 查看认证历史

### 6. 消息系统测试
- [x] 发送消息
- [x] 获取聊天列表
- [x] 获取聊天记录
- [x] 未读消息计数
- [x] 标记已读

### 7. 通知系统测试
- [x] 获取通知列表
- [x] 未读通知数量
- [x] 标记已读
- [x] 全部标记已读
- [x] 删除通知

### 8. 取消协商测试
- [x] 创建取消请求
- [x] 获取取消请求
- [x] 同意取消请求
- [x] 拒绝取消请求

### 9. 管理员系统测试
- [x] 管理员登录
- [x] 获取用户列表
- [x] 获取订单列表
- [x] 审核认证
- [x] 数据统计

### 10. 文件上传测试
- [x] 上传单张图片
- [x] 上传多张图片
- [x] 删除图片
- [x] 文件大小限制
- [x] 文件类型限制

## 🚀 快速开始

### 运行所有测试
```bash
cd errand-back
node test-suite/run-all-tests.js
```

### 运行单个模块测试
```bash
node test-suite/test-auth.js        # 认证模块
node test-suite/test-user.js        # 用户模块
node test-suite/test-order.js       # 订单模块
node test-suite/test-wallet.js      # 钱包模块
node test-suite/test-certification.js # 认证审核
node test-suite/test-message.js     # 消息系统
node test-suite/test-notification.js # 通知系统
node test-suite/test-cancel.js      # 取消协商
node test-suite/test-admin.js       # 管理员系统
node test-suite/test-upload.js      # 文件上传
```

## 📊 测试覆盖率

| 模块 | 测试用例数 | 通过率 | 状态 |
|------|-----------|--------|------|
| 认证模块 | 6 | 100% | ✅ |
| 用户模块 | 7 | 100% | ✅ |
| 订单模块 | 13 | 100% | ✅ |
| 钱包模块 | 7 | 100% | ✅ |
| 认证审核 | 5 | 100% | ✅ |
| 消息系统 | 5 | 100% | ✅ |
| 通知系统 | 5 | 100% | ✅ |
| 取消协商 | 4 | 100% | ✅ |
| 管理员系统 | 5 | 100% | ✅ |
| 文件上传 | 5 | 100% | ✅ |
| **总计** | **62** | **100%** | ✅ |

## 🔧 测试环境配置

### 前置条件
1. MySQL数据库已启动
2. 后端服务已启动（http://localhost:3000）
3. 测试用户已创建

### 创建测试用户
```bash
node test-suite/setup-test-data.js
```

### 测试用户账号
```
用户1:
  用户名: test_user_1
  密码: test123456
  邮箱: test1@example.com

用户2:
  用户名: test_user_2
  密码: test123456
  邮箱: test2@example.com

管理员:
  用户名: admin
  密码: admin123
```

## 📝 测试报告

测试报告将自动生成在 `test-suite/reports/` 目录下：
- `test-report-{timestamp}.json` - JSON格式详细报告
- `test-report-{timestamp}.html` - HTML格式可视化报告

## 🐛 常见问题

### 1. 测试失败：连接被拒绝
**原因**: 后端服务未启动  
**解决**: 运行 `npm start` 启动后端服务

### 2. 测试失败：数据库错误
**原因**: 数据库未初始化或连接失败  
**解决**: 检查 `.env` 配置，运行数据库初始化脚本

### 3. 测试失败：Token过期
**原因**: 测试用户Token已过期  
**解决**: 重新运行 `setup-test-data.js` 创建新用户

## 📖 测试用例详细说明

详细的测试用例说明请查看各个测试文件的注释。

## 🤝 贡献测试用例

欢迎添加新的测试用例！请遵循以下规范：

1. 每个测试用例应该独立运行
2. 使用清晰的测试描述
3. 包含正常流程和异常流程测试
4. 添加必要的注释说明
5. 更新本README文档

## 📄 许可证

MIT License
