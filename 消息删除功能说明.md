# 消息删除功能说明

## 功能概述
在消息中心页面添加了滑动删除对话的功能，用户可以通过左滑会话项来删除整个对话及其所有聊天记录。

## 实现内容

### 后端实现

#### 1. 数据模型 (Message.js)
- 新增 `deleteConversation(orderId, userId)` 方法
- 删除指定用户在某个订单中的所有消息记录

#### 2. 控制器 (message.controller.js)
- 新增 `deleteConversation` 方法
- 验证用户权限（必须是订单参与者）
- 返回删除的消息数量

#### 3. 路由 (message.routes.js)
- 新增 DELETE `/messages/conversation/:orderId` 路由
- 需要用户认证

### 前端实现

#### 1. API 接口 (api/message.js)
- 新增 `deleteConversation(orderId)` 方法
- 调用后端删除接口

#### 2. 页面逻辑 (pages/message/center.js)
- 添加触摸事件处理：
  - `onTouchStart`: 记录触摸起始位置
  - `onTouchMove`: 处理滑动动画
  - `onTouchEnd`: 判断是否显示删除按钮
- 添加 `onDeleteConversation` 方法：
  - 显示确认对话框
  - 调用删除 API
  - 更新本地列表

#### 3. 页面结构 (pages/message/center.wxml)
- 使用 `conversation-wrapper` 包裹每个会话项
- 会话项支持滑动（transform: translateX）
- 添加删除按钮（隐藏在右侧）

#### 4. 样式 (pages/message/center.wxss)
- 会话包装器使用相对定位和溢出隐藏
- 删除按钮绝对定位在右侧
- 红色背景，白色文字

## 使用方法

1. 打开消息中心页面
2. 在任意会话项上向左滑动
3. 显示红色的"删除"按钮
4. 点击删除按钮
5. 确认删除操作
6. 对话从列表中移除

## 交互细节

- **滑动阈值**: 滑动距离超过删除按钮宽度的一半（60rpx）时显示删除按钮
- **动画效果**: 使用 CSS transition 实现平滑的滑动动画
- **确认对话框**: 删除前弹出确认框，防止误操作
- **加载提示**: 删除过程中显示"删除中..."提示
- **结果反馈**: 删除成功后显示 Toast 提示

## 权限控制

- 只有订单的参与者（发布者或接单者）可以删除对话
- 删除操作会清空该用户在该订单中的所有消息记录
- 对方用户的消息记录不受影响

## 注意事项

1. 删除操作不可恢复，请谨慎操作
2. 删除对话不会影响订单本身的状态
3. 删除后如果有新消息，会话会重新出现在列表中
4. 滑动删除只在消息中心页面可用，聊天详情页面不支持
