# 管理员系统部署检查清单

## 📋 部署前检查

### 1. 环境准备
- [ ] Node.js 已安装（建议 v14 或以上）
- [ ] MySQL 数据库已安装并运行
- [ ] npm 依赖已安装（`npm install`）
- [ ] `.env` 文件已配置正确

### 2. 数据库配置
- [ ] 数据库连接信息正确
  - DB_HOST
  - DB_PORT
  - DB_USER
  - DB_PASSWORD
  - DB_NAME
- [ ] 数据库可以正常连接
- [ ] 现有数据表已创建（users, orders, certifications 等）

### 3. 后端配置
- [ ] JWT_SECRET 已设置（建议使用强密码）
- [ ] 端口配置正确（默认 3000）
- [ ] CORS 配置正确
- [ ] 文件上传路径配置正确

---

## 🚀 部署步骤

### 步骤 1：初始化管理员系统

```bash
cd errand-back
node create-admin-table.js
```

**检查点：**
- [ ] 看到 "✓ 管理员表创建成功"
- [ ] 看到 "✓ 默认管理员账号创建成功"
- [ ] 看到默认账号信息（admin / admin123）

### 步骤 2：启动后端服务

```bash
cd errand-back
npm start
```

**检查点：**
- [ ] 看到 "MySQL 连接成功"
- [ ] 看到 "服务器运行在端口 3000"
- [ ] 没有错误信息

### 步骤 3：测试管理员系统

```bash
cd errand-back
node test-admin-system.js
```

**检查点：**
- [ ] 所有测试通过
- [ ] 登录测试成功
- [ ] 统计数据获取成功
- [ ] 用户列表获取成功
- [ ] 订单列表获取成功
- [ ] 认证列表获取成功
- [ ] 无效 Token 测试通过

### 步骤 4：访问管理后台

打开浏览器访问 `errand-admin/index.html`

**检查点：**
- [ ] 页面正常显示
- [ ] 登录表单可见
- [ ] 样式正常加载

### 步骤 5：测试登录

使用默认账号登录：
- 用户名：`admin`
- 密码：`admin123`

**检查点：**
- [ ] 登录成功
- [ ] 跳转到管理后台
- [ ] 显示管理员名称
- [ ] 左侧菜单显示正常

### 步骤 6：测试各项功能

#### 数据统计
- [ ] 统计卡片显示正常
- [ ] 数据正确显示

#### 用户管理
- [ ] 用户列表加载成功
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 分页功能正常
- [ ] 查看用户详情正常

#### 订单管理
- [ ] 订单列表加载成功
- [ ] 搜索功能正常
- [ ] 筛选功能正常
- [ ] 分页功能正常
- [ ] 查看订单详情正常

#### 认证审核
- [ ] 认证列表加载成功
- [ ] 筛选功能正常
- [ ] 查看认证详情正常
- [ ] 证件照片显示正常
- [ ] 审核通过功能正常
- [ ] 审核拒绝功能正常

---

## 🔒 安全配置

### 1. 修改默认密码
- [ ] 首次登录后立即修改默认管理员密码
- [ ] 使用强密码（至少 8 位，包含大小写字母、数字、特殊字符）

### 2. JWT 配置
- [ ] JWT_SECRET 使用强随机字符串
- [ ] Token 过期时间设置合理（默认 24 小时）

### 3. 访问控制
- [ ] 管理后台仅在内网访问
- [ ] 或通过 VPN 访问
- [ ] 不要暴露在公网

### 4. HTTPS 配置（生产环境）
- [ ] 配置 SSL 证书
- [ ] 强制使用 HTTPS
- [ ] 配置 HSTS

### 5. 数据库安全
- [ ] 数据库密码足够强
- [ ] 数据库仅允许本地或内网访问
- [ ] 定期备份数据库

---

## 📊 性能优化

### 1. 数据库优化
- [ ] 为常用查询字段添加索引
- [ ] 定期清理过期数据
- [ ] 监控数据库性能

### 2. 前端优化
- [ ] 启用浏览器缓存
- [ ] 压缩静态资源
- [ ] 使用 CDN（可选）

### 3. 后端优化
- [ ] 启用 gzip 压缩
- [ ] 配置请求限流
- [ ] 监控服务器性能

---

## 🔍 监控和日志

### 1. 日志配置
- [ ] 配置访问日志
- [ ] 配置错误日志
- [ ] 配置管理员操作日志

### 2. 监控配置
- [ ] 监控服务器运行状态
- [ ] 监控数据库连接
- [ ] 监控 API 响应时间
- [ ] 设置告警规则

### 3. 定期检查
- [ ] 每日检查错误日志
- [ ] 每周检查系统性能
- [ ] 每月检查安全日志

---

## 🔄 备份策略

### 1. 数据库备份
- [ ] 配置自动备份（建议每日）
- [ ] 测试备份恢复流程
- [ ] 异地存储备份文件

### 2. 代码备份
- [ ] 使用 Git 版本控制
- [ ] 定期推送到远程仓库
- [ ] 标记重要版本

### 3. 配置备份
- [ ] 备份 .env 文件（注意安全）
- [ ] 备份 nginx/apache 配置
- [ ] 备份 SSL 证书

---

## 🐛 故障排查

### 常见问题

#### 1. 数据库连接失败
**症状：** 启动时报错 "数据库连接错误"

**排查步骤：**
- [ ] 检查 MySQL 服务是否运行
- [ ] 检查 .env 中的数据库配置
- [ ] 检查数据库用户权限
- [ ] 检查防火墙设置

#### 2. 管理员表创建失败
**症状：** 运行 create-admin-table.js 报错

**排查步骤：**
- [ ] 检查数据库连接
- [ ] 检查数据库用户是否有创建表权限
- [ ] 检查表是否已存在
- [ ] 查看详细错误信息

#### 3. 登录失败
**症状：** 输入正确密码仍无法登录

**排查步骤：**
- [ ] 检查后端服务是否运行
- [ ] 检查浏览器控制台错误
- [ ] 检查 API_BASE_URL 配置
- [ ] 检查 CORS 配置
- [ ] 检查管理员账号是否存在

#### 4. Token 验证失败
**症状：** 登录后操作提示未授权

**排查步骤：**
- [ ] 检查 JWT_SECRET 配置
- [ ] 检查 Token 是否过期
- [ ] 检查请求头是否正确携带 Token
- [ ] 清除浏览器缓存重新登录

#### 5. 图片无法显示
**症状：** 认证详情中的证件照片无法显示

**排查步骤：**
- [ ] 检查 uploads 目录是否存在
- [ ] 检查文件权限
- [ ] 检查静态文件服务配置
- [ ] 检查图片路径是否正确

---

## 📝 维护计划

### 每日维护
- [ ] 检查服务运行状态
- [ ] 查看错误日志
- [ ] 处理待审核认证

### 每周维护
- [ ] 检查系统性能
- [ ] 清理临时文件
- [ ] 更新统计报表

### 每月维护
- [ ] 数据库优化
- [ ] 安全审计
- [ ] 备份验证
- [ ] 更新依赖包

### 每季度维护
- [ ] 系统升级
- [ ] 性能优化
- [ ] 安全加固
- [ ] 灾难恢复演练

---

## ✅ 部署完成确认

### 最终检查清单
- [ ] 所有测试通过
- [ ] 默认密码已修改
- [ ] 安全配置已完成
- [ ] 备份策略已配置
- [ ] 监控已启用
- [ ] 文档已更新
- [ ] 团队已培训

### 交付文档
- [ ] 部署文档
- [ ] 使用手册
- [ ] API 文档
- [ ] 故障排查指南
- [ ] 联系方式

---

## 📞 支持联系

如遇到问题，请按以下顺序排查：

1. 查看本检查清单
2. 查看 `管理员系统使用说明.md`
3. 查看 `管理员系统快速参考.md`
4. 查看错误日志
5. 联系技术支持

---

**部署日期：** _______________

**部署人员：** _______________

**审核人员：** _______________

**签字确认：** _______________
